#! /bin/bash

read -p "Enter Table name : " tname

AssocDB=$1

if [[ -f DBs/$AssocDB/$tname ]]; then
    echo Table already exists
    source ./TableScripts/CreateTable $AssocDB
fi

touch "DBs/$AssocDB/$tname"
touch "DBs/$AssocDB/schema_$tname"

read -p "Enter Number of columns : " colnum

if [ $colnum -eq 0 ]; then
    echo invalid number of columns
    source ./TableScripts/CreateTable $AssocDB
fi

declare -A schema=(["Column"]="DataType")  # -A means associative array

flag=false

source ./TableScripts/HelperFunctions

for ((i = 0; i < $colnum; i++)); do
    
    # Check for field name
    read -p "Enter $((i+1))-th column name (Any table MUST have a pk) : " fname
    checkName $fname

    # Check for primary key
    read -p "Do you want to use this column as a primary key ?? [y|Y OR n|N] " ans
    checkPrimaryKey

    # Check for dtype
    echo Enter Data type of column :
    checkDataType
    
done

echo Table created successfully

output_file="DBs/$AssocDB/schema_$tname"
echo "$PrimaryKey" >> $output_file

for key in "${!schema[@]}"; do
    echo "$key:${schema[$key]}" >> "$output_file"
done

unset schema



